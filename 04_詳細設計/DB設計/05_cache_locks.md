# CacheLocks テーブル詳細設計

## ドキュメント目的
- Laravelキャッシュロック機能で使用する`cache_locks`テーブルの構造・運用ルールを定義する。
- ロック方式の変更時は本書とアプリ設定を更新する。

## 1. 基本情報
| 項目 | 内容 | 備考 |
|---|---|---|
| テーブル物理名 | cache_locks |  |
| テーブル論理名 | キャッシュロック |  |
| ドメイン/コンテキスト | Infra（キャッシュ） |  |
| 主キー | key（VARCHAR(255)） |  |

## 2. カラム定義
| No | カラム名 | 論理名 | 型 | PK | Not Null | デフォルト | 説明/業務ルール | 備考 |
|---|---|---|---|---|---|---|---|---|
| 1 | key | ロックキー | VARCHAR(255) | ○ | ○ |  | ロック対象識別子。 | 主キー |
| 2 | owner | 所有者トークン | VARCHAR(255) |  | ○ |  | ロック獲得者の識別値。 |  |
| 3 | expiration | 有効期限 | INT |  | ○ |  | UNIXタイムスタンプ（秒）。期限切れでロック解放。 |  |

## 3. インデックス・キー設計
| 種別 | 名称 | 対象カラム | ユニーク | 用途/目的 | 備考 |
|---|---|---|---|---|---|
| 主キー | PRIMARY | key | ○ | ロックキー一意性 |  |

## 4. 制約・リレーション
| 種別 | 名称 | 内容 | 備考 |
|---|---|---|---|
| 主キー | PRIMARY | key単位でロックを一意に管理 |  |
| 運用ルール | owner/expiration管理 | 期限切れチェックと再取得はアプリ側で制御。 |  |

## 改定履歴
| 改定日 | 版数 | 変更概要 | 担当 |
|---|---|---|---|
| 2025-09-19 | v0.1 | 新規作成 |  |
| 2025-10-10 | v1 | フェーズ0.5のリリース版 | Codex AI |